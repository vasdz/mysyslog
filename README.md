## Описание проекта

**mysyslog** — это расширяемая библиотека на языке C для логирования, поддерживающая различные форматы и уровни записи в журнал. 

### Основные возможности:
- Поддержка пяти уровней журналирования: `DEBUG`, `INFO`, `WARN`, `ERROR`, `CRITICAL`.
- Возможность вывода данных в журнал в двух форматах:
  - **Текстовый формат**: запись с разделителем.
  - **JSON формат**: структурированный JSON-вывод.
- Расширяемая архитектура с подключаемыми плагинами-драйверами.
- Предоставление удобного API для интеграции с другими программами.
- Инструменты для тестирования (клиентское приложение) и демон для автоматического логирования.

---

## Описание структуры проекта

### Директории:
- **libmysyslog** — основная библиотека для логирования.
- **libmysyslog-text** — драйвер для логирования в текстовом формате.
- **libmysyslog-json** — драйвер для логирования в формате JSON.
- **mysyslog-client** — тестовое клиентское приложение для логирования.
- **mysyslog-daemon** — демон для автоматического логирования.

### Форматы журналирования:
#### Текстовый формат:
```
timestamp log_level process message
```
**Пример:**
```
1439482969 ERROR example-app this is an error
```

#### JSON формат:
```
{"timestamp": ..., "log_level": ..., "process": ..., "message": ...}
```
**Пример:**
```json
{
    "timestamp": 1439482969,
    "log_level": "ERROR",
    "process": "example-app",
    "message": "this is an error"
}
```

---

## Использование

### Библиотека `libmysyslog`

API предоставляет функцию:
```c
int mysyslog(const char* msg, int level, int driver, int format, const char* path);
```

- **`msg`** — сообщение для записи.
- **`level`** — уровень логирования (DEBUG, INFO, WARN, ERROR, CRITICAL).
- **`driver`** — используемый драйвер (TEXT_DRIVER, JSON_DRIVER).
- **`format`** — формат вывода (расширяемый параметр).
- **`path`** — путь к файлу для записи.

### Приложение `mysyslog-client`
Позволяет передавать параметры через командную строку:
```
Usage: mysyslog-client -m <message> -l <log_level> -d <driver> -f <format> -p <path>
```

### Демон `mysyslog-daemon`
Демон автоматически записывает логи с интервалом и настраивается через файл `/etc/mysyslog/mysyslog.cfg`.

**Пример файла конфигурации:**
```
level=1
driver=0
format=0
path=/var/log/mysyslog.log
```

Демон поддерживает управление через `systemctl`:
- **Запуск:** `sudo systemctl start mysyslog`
- **Остановка:** `sudo systemctl stop mysyslog`

---

## Сборка проекта

### Общие команды Makefile:
- **`make all`** — собирает все цели.
- **`make clean`** — удаляет временные файлы.
- **`make deb`** — собирает `.deb` пакеты.

### Общий Makefile:
- Собирает все программы и библиотеки.
- Формирует репозиторий через цель `repo`.

### Пакеты:
Для каждой программы и библиотеки создаются отдельные `.deb` пакеты:
- `libmysyslog`
- `libmysyslog-text`
- `libmysyslog-json`
- `mysyslog-client`
- `mysyslog-daemon`

Создаётся метапакет `mysyslog-meta`, который автоматически устанавливает все компоненты.

---

## Развёртывание

### Создание репозитория
1. Создать репозиторий из подготовленных `.deb` пакетов.
2. Развернуть репозиторий на сервере.
3. Настроить клиента для доступа к репозиторию.

### Установка метапакета
1. Установить метапакет `mysyslog-meta`:
   ```
   sudo apt install mysyslog-meta
   ```
2. Настроить демон через файл конфигурации.

---

## Тестирование
1. Проверить работу `mysyslog-client`, задав параметры через командную строку.
2. Проверить работу демона `mysyslog-daemon`, включая запись в лог при изменении настроек.

---
